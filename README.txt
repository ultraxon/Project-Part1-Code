This code has a extremely low efficiency on estimate the parameters for we really do not have enough time to think twice on how to use matrix operations when using the MAP method.
So we used a way directly follows the way we analysis this problem on paper by hand but costs much more time.
DO NOT RUN THE PARAMETER ESTIMATION PART ON A LAPTOP WITHOUT POWER SUPPLY PLUGED IN!!!!!!